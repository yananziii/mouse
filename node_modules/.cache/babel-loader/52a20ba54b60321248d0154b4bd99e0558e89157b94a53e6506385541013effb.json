{"ast":null,"code":"import { getSituation, editSituation, getSituationNoKey } from \"../../api/api.js\";\nimport { getToken } from \"../../utils/setToken.js\";\nexport default {\n  data() {\n    return {\n      //实际交付日期必须早于今天\n      pickerOptions: {\n        disabledDate(time) {\n          return time.getTime() > Date.now();\n        }\n      },\n      //获取项目信息的参数对象\n      SituationList: [],\n      //需求方搜索框\n      demands: \"\",\n      //项目名称搜索框\n      names: \"\",\n      // 总条数\n      totalCount: 0,\n      // 默认显示第几页\n      currentPage: 1,\n      // 个数选择器\n      pageSizes: [5, 10],\n      // 默认每页显示的条数\n      PageSize: 5,\n      //控制交付填写表单的隐藏与显示\n      //添加表单\n      //控制修改表单对话框的显示隐藏\n      editDialogVisible: false,\n      //验收模式前后端对照\n      modelList: [{\n        label: \"单盲\",\n        value: 1\n      }, {\n        label: \"双盲\",\n        value: 2\n      }, {\n        label: \"抽检\",\n        value: 3\n      }, {\n        label: \"其他\",\n        value: 4\n      }, {\n        label: \"多盲\",\n        value: 5\n      }],\n      //是否一次性交付前后端对照\n      oneList: [{\n        label: \"是\",\n        value: 0\n      }, {\n        label: \"否\",\n        value: 1\n      }],\n      //是否按时标注前后端对照\n      submitList: [{\n        label: \"是\",\n        value: 0\n      }, {\n        label: \"否\",\n        value: 1\n      }],\n      //供应商多选\n      providers: [{\n        value: \"GX\",\n        label: \"保定国信\"\n      }, {\n        value: \"YD\",\n        label: \"成都亿达\"\n      }, {\n        value: \"JH\",\n        label: \"大连金慧\"\n      }, {\n        value: \"YT\",\n        label: \"盐城云腾\"\n      }, {\n        value: \"WD\",\n        label: \"永川文德\"\n      }, {\n        value: \"RR\",\n        label: \"热热\"\n      }, {\n        value: \"WH\",\n        label: \"HRO\"\n      }],\n      editForm: {\n        id: \"\",\n        project_state: \"\",\n        demand_role: \"\",\n        project_name: \"\",\n        project_number: \"\",\n        provider: \"\",\n        project_expert: \"\",\n        delivery_time: \"\",\n        mark_cpd: \"\",\n        quality_cpd: \"\",\n        ac_requ: \"\",\n        book_con: \"\",\n        project_con: \"\",\n        accept_model: 0,\n        actual_time: \"\",\n        deli_note: \"\",\n        is_submit: \"\",\n        is_one: \"\",\n        return_num: \"\",\n        work_num: \"\"\n      },\n      //修改表单的验证规则\n      editFormRules: {\n        ac_requ: [{\n          required: true,\n          message: \"准确率要求为必填项！\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  created() {\n    this.id = JSON.parse(getToken(\"work_num\"));\n    this.editForm.work_num = JSON.parse(getToken(\"work_num\"));\n    /*     this.token = JSON.parse(getToken(\"admin_token\")); */\n    this.getListNoKey();\n  },\n  methods: {\n    formatter(row, column) {\n      var data = row[column.property];\n      if (data == null) {\n        return data;\n      }\n      data = data.toString();\n      data = data.replace(/\\'/g, \"\");\n      data = data.replace(/\\[/g, \"\");\n      data = data.replace(/\\]/g, \"\");\n      data = data.replace(/\\s*/g, \"\");\n      data = data.replace(/\\s*/g, \"\");\n      data = data.replace(/GX/g, \"保定国信\");\n      data = data.replace(/YD/g, \"成都亿达\");\n      data = data.replace(/JH/g, \"大连金慧\");\n      data = data.replace(/YT/g, \"盐城云腾\");\n      data = data.replace(/WD/g, \"永川文德\");\n      data = data.replace(/RR/g, \"热热\");\n      data = data.replace(/WH/g, \"HRO\");\n      return data;\n    },\n    getListNoKey() {\n      getSituationNoKey(this.id, this.currentPage, this.PageSize).then(res => {\n        if (res.data.ret == 0) {\n          this.SituationList = res.data.data_list;\n          this.totalCount = res.data.total;\n        }\n      });\n    },\n    getList() {\n      getSituation(this.id, this.currentPage, this.PageSize, this.demands, this.names).then(res => {\n        if (res.data.ret == 0) {\n          this.SituationList = res.data.data_list;\n          this.totalCount = res.data.total;\n        }\n      });\n    },\n    fifterUrl(url) {\n      var match = /^((ht|f)tps?):\\/\\/[\\w\\-]+(\\.[\\w\\-]+)+([\\w\\-\\.,@?^=%&:\\/~\\+#]*[\\w\\-\\@?^=%&\\/~\\+#])?$/;\n      return match.test(url);\n    },\n    handleSizeChange(val) {\n      // 改变每页显示的条数\n      this.PageSize = val;\n      // 注意：在改变每页显示的条数时，要将页码显示到第一页\n      this.currentPage = 1;\n      // 点击每页显示的条数时，显示第一页\n      if (this.demands == '' && this.names == '') return this.getListNoKey();\n      this.getList();\n    },\n    handleCurrentChange(val) {\n      // 改变默认的页数\n      this.currentPage = val;\n      // 切换页码时，要获取每页显示的条数\n      if (this.demands == '' && this.names == '') return this.getListNoKey();\n      this.getList();\n    },\n    search() {\n      this.currentPage = 1;\n      if (this.demands == '' && this.names == '') return this.getListNoKey();\n      this.getList();\n    },\n    //修改表单更改日期格式\n    getEditDateD(date) {\n      this.editForm.delivery_time = date;\n    },\n    //修改表单更改日期格式\n    getEditDateA(date) {\n      this.editForm.actual_time = date;\n    },\n    /* 监听添加需求对话框关闭重置 */\n    addDialogClosed() {\n      this.$refs.addFormRef.resetFields();\n    },\n    //展示编辑需求的对话框\n    showEditDialogList(id, project_number, project_state, demand_role, project_name, provider, project_expert, delivery_time, mark_cpd, quality_cpd, ac_requ, book_con, project_con, accept_model, actual_time, deli_note, is_submit, is_one, return_num) {\n      this.editDialogVisible = true;\n      this.editForm.id = id;\n      this.editForm.project_number = project_number;\n      this.editForm.project_state = project_state;\n      this.editForm.demand_role = demand_role;\n      this.editForm.project_name = project_name;\n      this.editForm.provider = provider;\n      this.editForm.project_expert = project_expert;\n      this.editForm.delivery_time = delivery_time;\n      this.editForm.mark_cpd = mark_cpd;\n      this.editForm.quality_cpd = quality_cpd;\n      this.editForm.ac_requ = ac_requ;\n      this.editForm.book_con = book_con;\n      this.editForm.project_con = project_con;\n      this.editForm.accept_model = accept_model;\n      this.editForm.actual_time = actual_time;\n      this.editForm.deli_note = deli_note;\n      this.editForm.is_submit = is_submit;\n      this.editForm.is_one = is_one;\n      this.editForm.return_num = return_num;\n      if (this.editForm.provider) {\n        this.editForm.provider = this.editForm.provider.toString();\n        this.editForm.provider = this.editForm.provider.replace(/\\'/g, \"\");\n        this.editForm.provider = this.editForm.provider.replace(/\\[/g, \"\");\n        this.editForm.provider = this.editForm.provider.replace(/\\]/g, \"\");\n        this.editForm.provider = this.editForm.provider.replace(/\\s*/g, \"\");\n        this.editForm.provider = this.editForm.provider.split(\",\");\n      }\n      console.log(this.editForm.provider);\n    },\n    checkEdit(state, provider, mark_cpd, quality_cpd, ac_requ, actual_time, is_submit, is_one) {\n      console.log(mark_cpd);\n      if (state == 3 && provider == \"\") {\n        return false;\n      } else if (state == 3 && mark_cpd == null) {\n        return false;\n      } else if (state == 3 && quality_cpd == \"\") {\n        return false;\n      } else if (state == 3 && ac_requ == \"\") {\n        return false;\n      } else if (state == 5 && provider == \"\") {\n        return false;\n      } else if (state == 5 && mark_cpd == \"\") {\n        return false;\n      } else if (state == 5 && quality_cpd == \"\") {\n        return false;\n      } else if (state == 5 && ac_requ == \"\") {\n        return false;\n      } else if (state == 5 && actual_time == \"\") {\n        return false;\n      } else if (state == 5 && is_submit == \"\") {\n        return false;\n      } else if (state == 5 && is_one == \"\") {\n        return false;\n      } else {\n        return true;\n      }\n    },\n    /*  修改明细表单并提交 */\n    editList() {\n      //预校验\n      this.$refs.editFormRef.validate(valid => {\n        if (!valid) return;\n        if (this.checkEdit(this.editForm.state, this.editForm.provider, this.editForm.mark_cpd, this.editForm.quality_cpd, this.editForm.ac_requ, this.editForm.actual_time, this.editForm.is_submit, this.editForm.is_one)) {\n          editSituation(this.editForm).then(res => {\n            if (res.data.ret == 0) {\n              //关闭对话框\n              this.editDialogVisible = false;\n              //刷新数据列表\n              this.getListNoKey();\n              //提示\n              this.$message.success(\"更新成功！\");\n            }\n          });\n        } else {\n          this.$message.error(\"填写不规范，请重新填写\");\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["getSituation","editSituation","getSituationNoKey","getToken","data","pickerOptions","disabledDate","time","getTime","Date","now","SituationList","demands","names","totalCount","currentPage","pageSizes","PageSize","editDialogVisible","modelList","label","value","oneList","submitList","providers","editForm","id","project_state","demand_role","project_name","project_number","provider","project_expert","delivery_time","mark_cpd","quality_cpd","ac_requ","book_con","project_con","accept_model","actual_time","deli_note","is_submit","is_one","return_num","work_num","editFormRules","required","message","trigger","created","JSON","parse","getListNoKey","methods","formatter","row","column","property","toString","replace","then","res","ret","data_list","total","getList","fifterUrl","url","match","test","handleSizeChange","val","handleCurrentChange","search","getEditDateD","date","getEditDateA","addDialogClosed","$refs","addFormRef","resetFields","showEditDialogList","split","console","log","checkEdit","state","editList","editFormRef","validate","valid","$message","success","error"],"sources":["src/components/Expert/Situation.vue"],"sourcesContent":["<template>\n  <div>\n      <el-card>\n    <!--     面包屑导航 -->\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\n      <el-breadcrumb-item :to=\"{ path: '/Notice' }\">首页</el-breadcrumb-item>\n      <el-breadcrumb-item>团队管理</el-breadcrumb-item>\n      <el-breadcrumb-item>项目详情</el-breadcrumb-item>\n    </el-breadcrumb>\n  </el-card>\n    <!-- 卡片视图 -->\n    <el-card>\n      <el-row :gutter=\"40\">\n          <el-col :span=\"15\" class=\"situ-data-des\">\n              项目\n          </el-col>\n        <el-col :span=\"3\">\n          <el-input placeholder=\"需求方\" v-model=\"demands\" \n          @keyup.enter.native=\"search\"\n          size=\"mini\"\n          clearable>\n          </el-input>\n        </el-col>\n        <el-col :span=\"3\">\n          <el-input placeholder=\"项目名称\" v-model=\"names\" \n          @keyup.enter.native=\"search\"\n          size=\"mini\"\n          clearable>\n          </el-input>\n        </el-col>\n        <el-col :span=\"3\">\n        <el-button icon=\"el-icon-search\" circle\n        size=\"mini\" @click=\"search\"> </el-button>\n        </el-col>\n      </el-row>\n\n      <!-- 项目详情列表 -->\n      <el-table :data=\"SituationList\"  stripe >\n        <el-table-column\n          fixed\n          prop=\"project_state\"\n          label=\"项目状态\"\n          width=\"100\"\n        >\n          <template slot-scope=\"scope\">\n            <span v-if=\"scope.row.project_state == 0\">分发中</span>\n            <span v-if=\"scope.row.project_state == 1\">待开启</span>\n            <span v-if=\"scope.row.project_state == 2\">试标中</span>\n            <span v-if=\"scope.row.project_state == 3\">进行中</span>\n            <span v-if=\"scope.row.project_state == 4\">暂停中</span>\n            <span v-if=\"scope.row.project_state == 5\">已交付</span>\n            <span v-if=\"scope.row.project_state == 6\">终止需求</span>\n          </template>\n        </el-table-column>\n        <el-table-column\n          label=\"需求方\"\n          prop=\"demand_role\"\n          fixed\n        ></el-table-column>\n        <el-table-column\n          label=\"项目名称\"\n          prop=\"project_name\"\n          fixed\n          min-width=\"170%\"\n        ></el-table-column>\n        <el-table-column\n          label=\"项目编号\"\n          prop=\"project_number\"\n          min-width=\"170%\"\n        ></el-table-column>\n        <el-table-column\n          label=\"供应商\"\n          prop=\"provider\"\n          min-width=\"170%\"\n          :formatter=\"formatter\"\n        >\n        </el-table-column>\n        <el-table-column\n          label=\"质控专家\"\n          prop=\"project_expert\"\n        ></el-table-column>\n        <el-table-column\n          label=\"期望交付时间\"\n          prop=\"delivery_time\"\n          min-width=\"120%\"\n        ></el-table-column>\n        <el-table-column label=\"标注CPD\" prop=\"mark_cpd\"></el-table-column>\n        <el-table-column label=\"质检CPD\" prop=\"quality_cpd\"></el-table-column>\n        <el-table-column\n          label=\"准确率要求\"\n          prop=\"ac_requ\"\n          min-width=\"100%\"\n        ></el-table-column>\n        <el-table-column label=\"验收模式\" prop=\"accept_model\">\n          <template slot-scope=\"scope\">\n            <span v-if=\"scope.row.accept_model == 1\">单盲</span>\n            <span v-if=\"scope.row.accept_model == 2\">双盲</span>\n            <span v-if=\"scope.row.accept_model == 3\">抽检</span>\n            <span v-if=\"scope.row.accept_model == 4\">其他</span>\n            <span v-if=\"scope.row.accept_model == 5\">多盲</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"任务书链接\" width=\"90%\" show-overflow-tooltip>\n          <template slot-scope=\"scope\">\n            <span v-if=\"fifterUrl(scope.row.book_con)\">\n              <a\n                :href=\"scope.row.book_con\"\n                target=\"_blank\"\n                class=\"buttonText\"\n                >{{ scope.row.book_con }}</a\n              >\n            </span>\n            <span v-else>{{ scope.row.book_con }}</span>\n          </template>\n        </el-table-column>\n        <el-table-column\n          label=\"项目管理表链接\"\n          width=\"120%\"\n          show-overflow-tooltip\n        >\n          <template slot-scope=\"scope\">\n            <span v-if=\"fifterUrl(scope.row.project_con)\">\n              <a\n                :href=\"scope.row.project_con\"\n                target=\"_blank\"\n                class=\"buttonText\"\n                >{{ scope.row.project_con }}</a\n              >\n            </span>\n            <span v-else>{{ scope.row.project_con }}</span>\n          </template>\n        </el-table-column>\n\n        <el-table-column\n          label=\"实际交付日期\"\n          prop=\"actual_time\"\n          min-width=\"100%\"\n        ></el-table-column>\n        <el-table-column label=\"是否按时交付\" prop=\"is_submit\" min-width=\"100%\">\n          <template slot-scope=\"scope\">\n            <span v-if=\"scope.row.is_submit == 0\">是</span>\n            <span v-if=\"scope.row.is_submit == 1\">否</span>\n            <span v-if=\"scope.row.is_submit == 2\">进行中</span>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"是否一次性交付\" prop=\"is_one\" min-width=\"120%\">\n          <template slot-scope=\"scope\">\n            <span v-if=\"scope.row.is_one == 0\">是</span>\n            <span v-if=\"scope.row.is_one == 1\">否</span>\n            <span v-if=\"scope.row.is_one == 2\">进行中</span>\n          </template>\n        </el-table-column>\n        <el-table-column\n          label=\"交付备注\"\n          prop=\"deli_note\"\n          :show-overflow-tooltip=\"true\"\n        ></el-table-column>\n        <el-table-column label=\"返修次数\" prop=\"return_num\"></el-table-column>\n        <el-table-column\n          label=\"项目经理/质控专家工号\"\n          prop=\"work_num\"\n          min-width=\"120%\"\n        ></el-table-column>\n        <el-table-column label=\"操作\" min-width=\"120%\">\n          <template slot-scope=\"scope\">\n            <el-tooltip\n              effect=\"dark\"\n              content=\"修改表单\"\n              placement=\"top\"\n              :enterable=\"false\"\n            >\n              <el-button\n                type=\"primary\"\n                icon=\"el-icon-edit\"\n                size=\"mini\"\n                @click=\"\n                  showEditDialogList(\n                    scope.row.id,\n                    scope.row.project_number,\n                    scope.row.project_state,\n                    scope.row.demand_role,\n                    scope.row.project_name,\n                    scope.row.provider,\n                    scope.row.project_expert,\n                    scope.row.delivery_time,\n                    scope.row.mark_cpd,\n                    scope.row.quality_cpd,\n                    scope.row.ac_requ,\n                    scope.row.book_con,\n                    scope.row.project_con,\n                    scope.row.accept_model,\n                    scope.row.actual_time,\n                    scope.row.deli_note,\n                    scope.row.is_submit,\n                    scope.row.is_one,\n                    scope.row.return_num,\n                    scope.row.work_num\n                  )\n                \"\n              ></el-button>\n            </el-tooltip>\n          </template>\n        </el-table-column>\n      </el-table>\n      <div>\n        <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"currentPage\"\n          :page-sizes=\"pageSizes\"\n          :page-size=\"PageSize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"totalCount\"\n        >\n        </el-pagination>\n      </div>\n    </el-card>\n    <!-- 修改项目详情表单的对话框 -->\n    <el-dialog\n      title=\"我的项目情况表单修改\"\n      :visible.sync=\"editDialogVisible\"\n      width=\"50%\"\n      :close-on-click-modal=\"false\"\n    >\n      <el-form\n        :model=\"editForm\"\n        :rules=\"editFormRules\"\n        ref=\"editFormRef\"\n        label-width=\"100px\"\n      >\n        <el-form-item label=\"需求方\" prop=\"demand_role\">\n          <el-input v-model=\"editForm.demand_role\" readonly></el-input>\n        </el-form-item>\n        <el-form-item label=\"项目名称\" prop=\"project_name\">\n          <el-input v-model=\"editForm.project_name\" readonly></el-input>\n        </el-form-item>\n        <el-form-item label=\"项目编号\" prop=\"project_number\">\n          <el-input v-model=\"editForm.project_number\" readonly></el-input>\n        </el-form-item>\n        <el-form-item label=\"供应商\" prop=\"provider\">\n          <el-select v-model=\"editForm.provider\" multiple>\n            <el-option\n              v-for=\"item in providers\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            >\n            </el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"质控专家\" prop=\"project_expert\">\n          <el-input v-model=\"editForm.project_expert\" readonly></el-input>\n        </el-form-item>\n        <el-form-item label=\"期望交付日期\" prop=\"delivery_time\">\n          <el-input\n            v-model=\"editForm.delivery_time\"\n            type=\"date\"\n            placeholder=\"选择日期\"\n            style=\"width: 100%\"\n            format=\"yyyy-MM-dd\"\n            value-format=\"yyyy-MM-dd\"\n            @change=\"getEditDateD\"\n            readonly\n          ></el-input>\n        </el-form-item>\n        <el-form-item label=\"标注CPD\" prop=\"mark_cpd\">\n          <el-input v-model=\"editForm.mark_cpd\" type=\"number\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"质检CPD\" prop=\"quality_cpd\">\n          <el-input v-model=\"editForm.quality_cpd\" type=\"number\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"准确率要求\" prop=\"ac_requ\">\n          <el-input\n            v-model=\"editForm.ac_requ\"\n            v-only-number=\"{ max: 1, min: 0, precision: 2 }\"\n            plachehold=\"请填写0-1以内的两位小数\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item label=\"验收模式\" prop=\"accept_model\">\n          <el-select v-model=\"editForm.accept_model\">\n            <el-option\n              v-for=\"item in modelList\"\n              :key=\"item.id\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"任务书链接\" prop=\"book_con\">\n          <el-input v-model=\"editForm.book_con\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"项目管理表链接\" prop=\"project_con\">\n          <el-input v-model=\"editForm.project_con\"></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"实际交付日期\" prop=\"actual_time\">\n<!--           <el-input\n            v-model=\"editForm.actual_time\"\n            type=\"date\"\n            placeholder=\"选择日期\"\n            style=\"width: 100%\"\n            format=\"yyyy-MM-dd\"\n            value-format=\"yyyy-MM-dd\"\n            @change=\"getEditDateA\"\n          ></el-input> -->\n          <el-date-picker v-model=\"editForm.actual_time\"\n     value-format=\"yyyy-MM-dd\" type=\"date\" placeholder=\"请选择日\"\n     :picker-options=\"pickerOptions\">\n   </el-date-picker>\n        </el-form-item>\n\n        <el-form-item label=\"是否按时标注\" prop=\"is_submit\">\n          <el-select v-model=\"editForm.is_submit\">\n            <el-option\n              v-for=\"item in submitList\"\n              :key=\"item.id\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"是否一次性交付\" prop=\"is_one\">\n          <el-select v-model=\"editForm.is_one\">\n            <el-option\n              v-for=\"item in oneList\"\n              :key=\"item.id\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"交付备注\" prop=\"deli_note\">\n          <el-input v-model=\"editForm.deli_note\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"返修次数\" prop=\"return_num\">\n          <el-input v-model=\"editForm.return_num\"></el-input>\n        </el-form-item>\n      </el-form>\n      <!--     底部 -->\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"editDialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"editList\" v-preventReClick>确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { getSituation, editSituation, getSituationNoKey } from \"../../api/api.js\";\nimport { getToken } from \"../../utils/setToken.js\";\nexport default {\n  data() {\n    return {\n         //实际交付日期必须早于今天\n    pickerOptions: {\n                disabledDate(time) {\n                    return time.getTime() > Date.now(); \n                }\n             },\n      //获取项目信息的参数对象\n      SituationList: [],\n      //需求方搜索框\n      demands: \"\",\n      //项目名称搜索框\n      names: \"\",\n      // 总条数\n      totalCount: 0,\n      // 默认显示第几页\n      currentPage: 1,\n      // 个数选择器\n      pageSizes: [5, 10],\n      // 默认每页显示的条数\n      PageSize: 5,\n      //控制交付填写表单的隐藏与显示\n      //添加表单\n      //控制修改表单对话框的显示隐藏\n      editDialogVisible: false,\n\n      //验收模式前后端对照\n      modelList: [\n        {\n          label: \"单盲\",\n          value: 1,\n        },\n        {\n          label: \"双盲\",\n          value: 2,\n        },\n        {\n          label: \"抽检\",\n          value: 3,\n        },\n        {\n          label: \"其他\",\n          value: 4,\n        },\n        {\n          label: \"多盲\",\n          value: 5,\n        },\n      ],\n      //是否一次性交付前后端对照\n      oneList: [\n        {\n          label: \"是\",\n          value: 0,\n        },\n        {\n          label: \"否\",\n          value: 1,\n        },\n\n      ],\n      //是否按时标注前后端对照\n      submitList: [\n        {\n          label: \"是\",\n          value: 0,\n        },\n        {\n          label: \"否\",\n          value: 1,\n        },\n\n      ],\n      //供应商多选\n      providers: [\n        {\n          value: \"GX\",\n          label: \"保定国信\",\n        },\n        {\n          value: \"YD\",\n          label: \"成都亿达\",\n        },\n        {\n          value: \"JH\",\n          label: \"大连金慧\",\n        },\n        {\n          value: \"YT\",\n          label: \"盐城云腾\",\n        },\n        {\n          value: \"WD\",\n          label: \"永川文德\",\n        },\n        {\n          value: \"RR\",\n          label: \"热热\",\n        },\n        {\n          value: \"WH\",\n          label: \"HRO\",\n        },\n      ],\n\n      editForm: {\n        id: \"\",\n        project_state: \"\",\n        demand_role: \"\",\n        project_name: \"\",\n        project_number: \"\",\n        provider: \"\",\n        project_expert: \"\",\n        delivery_time: \"\",\n        mark_cpd: \"\",\n        quality_cpd: \"\",\n        ac_requ: \"\",\n        book_con: \"\",\n        project_con: \"\",\n        accept_model: 0,\n        actual_time: \"\",\n        deli_note: \"\",\n        is_submit: \"\",\n        is_one: \"\",\n        return_num: \"\",\n        work_num: \"\"\n      },\n      //修改表单的验证规则\n      editFormRules: {\n        ac_requ: [\n          { required: true, message: \"准确率要求为必填项！\", trigger: \"blur\" },\n        ]\n      },\n    };\n  },\n  created() {\n    this.id = JSON.parse(getToken(\"work_num\"));\n    this.editForm.work_num = JSON.parse(getToken(\"work_num\"));\n/*     this.token = JSON.parse(getToken(\"admin_token\")); */\n    this.getListNoKey();\n  },\n  methods: {\n    formatter(row, column) {\n      var data = row[column.property];\n      if (data == null) {\n        return data;\n      }\n      data = data.toString();\n      data = data.replace(/\\'/g, \"\");\n      data = data.replace(/\\[/g, \"\");\n      data = data.replace(/\\]/g, \"\");\n      data = data.replace(/\\s*/g, \"\");\n      data = data.replace(/\\s*/g, \"\");\n      data = data.replace(/GX/g, \"保定国信\");\n      data = data.replace(/YD/g, \"成都亿达\");\n      data = data.replace(/JH/g, \"大连金慧\");\n      data = data.replace(/YT/g, \"盐城云腾\");\n      data = data.replace(/WD/g, \"永川文德\");\n      data = data.replace(/RR/g, \"热热\");\n      data = data.replace(/WH/g, \"HRO\");\n      return data;\n    },\n    getListNoKey() {\n      getSituationNoKey(\n        this.id,\n        this.currentPage,\n        this.PageSize\n      ).then((res) => {\n        if (res.data.ret == 0) {\n          this.SituationList = res.data.data_list;\n          this.totalCount = res.data.total;\n        }\n      });\n    },\n    getList() {\n      getSituation(\n        this.id,\n        this.currentPage,\n        this.PageSize,\n        this.demands,\n        this.names\n      ).then((res) => {\n        if (res.data.ret == 0) {\n          this.SituationList = res.data.data_list;\n          this.totalCount = res.data.total;\n        }\n      });\n    },\n    fifterUrl(url) {\n      var match =\n        /^((ht|f)tps?):\\/\\/[\\w\\-]+(\\.[\\w\\-]+)+([\\w\\-\\.,@?^=%&:\\/~\\+#]*[\\w\\-\\@?^=%&\\/~\\+#])?$/;\n      return match.test(url);\n    },\n\n    handleSizeChange(val) {\n      // 改变每页显示的条数\n      this.PageSize = val;\n      // 注意：在改变每页显示的条数时，要将页码显示到第一页\n      this.currentPage = 1;\n      // 点击每页显示的条数时，显示第一页\n      if(this.demands == '' && this.names == '') return this.getListNoKey()\n         this.getList()\n    },\n    handleCurrentChange(val) {\n      // 改变默认的页数\n      this.currentPage = val;\n      // 切换页码时，要获取每页显示的条数\n      if(this.demands == '' && this.names == '') return this.getListNoKey()\n         this.getList()\n    },\n    search() {\n      this.currentPage = 1;\n      if(this.demands == '' && this.names == '') return this.getListNoKey()\n         this.getList()\n    },\n\n    //修改表单更改日期格式\n    getEditDateD(date) {\n      this.editForm.delivery_time = date;\n    },\n    //修改表单更改日期格式\n    getEditDateA(date) {\n      this.editForm.actual_time = date;\n    },\n    /* 监听添加需求对话框关闭重置 */\n    addDialogClosed() {\n      this.$refs.addFormRef.resetFields();\n    },\n\n    //展示编辑需求的对话框\n    showEditDialogList(\n      id,\n      project_number,\n      project_state,\n      demand_role,\n      project_name,\n      provider,\n      project_expert,\n      delivery_time,\n      mark_cpd,\n      quality_cpd,\n      ac_requ,\n      book_con,\n      project_con,\n      accept_model,\n      actual_time,\n      deli_note,\n      is_submit,\n      is_one,\n      return_num,\n    ) {\n      this.editDialogVisible = true;\n      this.editForm.id = id;\n      this.editForm.project_number = project_number;\n      this.editForm.project_state = project_state;\n      this.editForm.demand_role = demand_role;\n      this.editForm.project_name = project_name;\n      this.editForm.provider = provider;\n      this.editForm.project_expert = project_expert;\n      this.editForm.delivery_time = delivery_time;\n      this.editForm.mark_cpd = mark_cpd;\n      this.editForm.quality_cpd = quality_cpd;\n      this.editForm.ac_requ = ac_requ;\n      this.editForm.book_con = book_con;\n      this.editForm.project_con = project_con;\n      this.editForm.accept_model = accept_model;\n      this.editForm.actual_time = actual_time;\n      this.editForm.deli_note = deli_note;\n      this.editForm.is_submit = is_submit;\n      this.editForm.is_one = is_one;\n      this.editForm.return_num = return_num;\n      if (this.editForm.provider) {\n        this.editForm.provider = this.editForm.provider.toString();\n        this.editForm.provider = this.editForm.provider.replace(/\\'/g, \"\");\n        this.editForm.provider = this.editForm.provider.replace(/\\[/g, \"\");\n        this.editForm.provider = this.editForm.provider.replace(/\\]/g, \"\");\n        this.editForm.provider = this.editForm.provider.replace(/\\s*/g, \"\");\n        this.editForm.provider = this.editForm.provider.split(\",\");\n      }\n      console.log(this.editForm.provider);\n    },\n    checkEdit(state, provider, mark_cpd, quality_cpd, ac_requ, actual_time, is_submit, is_one){\n      console.log(mark_cpd)\n    if(state ==3 && provider== \"\"){\n      return false\n    }else if(state ==3 && mark_cpd== null){\n      return false\n    }else if(state ==3 && quality_cpd== \"\"){\n      return false\n    }else if(state ==3 && ac_requ== \"\"){\n      return false\n    }else if(state ==5 && provider== \"\"){\n      return false\n    }else if(state ==5 && mark_cpd== \"\"){\n      return false\n    }else if(state ==5 && quality_cpd== \"\"){\n      return false\n    }else if(state ==5 && ac_requ== \"\"){\n      return false\n    }else if(state ==5 && actual_time== \"\"){\n      return false\n    }else if(state ==5 && is_submit== \"\"){\n      return false\n    }else if(state ==5 && is_one== \"\"){\n      return false\n    }else{\n      return true\n    }\n    },\n    /*  修改明细表单并提交 */\n    editList() {\n      //预校验\n      this.$refs.editFormRef.validate((valid) => {\n        if (!valid) return;\n        if(this.checkEdit(this.editForm.state,\n        this.editForm.provider,\n        this.editForm.mark_cpd,\n        this.editForm.quality_cpd,\n        this.editForm.ac_requ,\n        this.editForm.actual_time,\n        this.editForm.is_submit,\n        this.editForm.is_one\n        )){\n          editSituation(this.editForm).then((res) => {\n          if (res.data.ret == 0) {\n            //关闭对话框\n            this.editDialogVisible = false;\n            //刷新数据列表\n            this.getListNoKey();\n            //提示\n            this.$message.success(\"更新成功！\");\n          }\n        });\n        }else{\n          this.$message.error(\"填写不规范，请重新填写\")\n\n        }\n      });\n    },\n \n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.situ-data-des{\n  font-size: 15px;\n  font-weight: 600;\n  padding-top: 8px;\n}</style>\n"],"mappings":"AA4VA,SAAAA,YAAA,EAAAC,aAAA,EAAAC,iBAAA;AACA,SAAAC,QAAA;AACA;EACAC,KAAA;IACA;MACA;MACAC,aAAA;QACAC,aAAAC,IAAA;UACA,OAAAA,IAAA,CAAAC,OAAA,KAAAC,IAAA,CAAAC,GAAA;QACA;MACA;MACA;MACAC,aAAA;MACA;MACAC,OAAA;MACA;MACAC,KAAA;MACA;MACAC,UAAA;MACA;MACAC,WAAA;MACA;MACAC,SAAA;MACA;MACAC,QAAA;MACA;MACA;MACA;MACAC,iBAAA;MAEA;MACAC,SAAA,GACA;QACAC,KAAA;QACAC,KAAA;MACA,GACA;QACAD,KAAA;QACAC,KAAA;MACA,GACA;QACAD,KAAA;QACAC,KAAA;MACA,GACA;QACAD,KAAA;QACAC,KAAA;MACA,GACA;QACAD,KAAA;QACAC,KAAA;MACA,EACA;MACA;MACAC,OAAA,GACA;QACAF,KAAA;QACAC,KAAA;MACA,GACA;QACAD,KAAA;QACAC,KAAA;MACA,EAEA;MACA;MACAE,UAAA,GACA;QACAH,KAAA;QACAC,KAAA;MACA,GACA;QACAD,KAAA;QACAC,KAAA;MACA,EAEA;MACA;MACAG,SAAA,GACA;QACAH,KAAA;QACAD,KAAA;MACA,GACA;QACAC,KAAA;QACAD,KAAA;MACA,GACA;QACAC,KAAA;QACAD,KAAA;MACA,GACA;QACAC,KAAA;QACAD,KAAA;MACA,GACA;QACAC,KAAA;QACAD,KAAA;MACA,GACA;QACAC,KAAA;QACAD,KAAA;MACA,GACA;QACAC,KAAA;QACAD,KAAA;MACA,EACA;MAEAK,QAAA;QACAC,EAAA;QACAC,aAAA;QACAC,WAAA;QACAC,YAAA;QACAC,cAAA;QACAC,QAAA;QACAC,cAAA;QACAC,aAAA;QACAC,QAAA;QACAC,WAAA;QACAC,OAAA;QACAC,QAAA;QACAC,WAAA;QACAC,YAAA;QACAC,WAAA;QACAC,SAAA;QACAC,SAAA;QACAC,MAAA;QACAC,UAAA;QACAC,QAAA;MACA;MACA;MACAC,aAAA;QACAV,OAAA,GACA;UAAAW,QAAA;UAAAC,OAAA;UAAAC,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"},"metadata":{},"sourceType":"module","externalDependencies":[]}